import{d as w,u as Q,r as m,o as E,a as u,b as t,I as N,f as a,g as v,h as f,F as S,l as T,j as l,t as i,p as b,i as F,J as M,s as p,K as z,G as A,_ as D}from"./index-Cs2oV9HB.js";const L={class:"cart-page"},j={class:"site-header"},q={class:"container header-content"},G={key:0,class:"container cart-container"},J={class:"cart-header"},K={class:"col col-check"},P={class:"cart-item-list"},H={class:"col col-check"},O={class:"col col-img"},R=["src"],W={class:"col col-name"},X={class:"col col-price"},Y={class:"col col-num"},Z={class:"col col-total",style:{color:"#ff6700"}},ee={class:"col col-action"},te={class:"cart-bar"},oe={class:"section-left"},se={class:"total-count"},le={class:"total-price"},ae={key:1,class:"container empty-cart"},ne=w({__name:"Cart",setup(ce){const k=Q(),n=m([]),h=m(!0),C=async()=>{if(!k.userInfo.userId)return;const o=await b.get(`/cart/list?userId=${k.userInfo.userId}`);n.value=o.map(e=>({...e,selectedBoolean:e.selected===1})),_()},I=o=>o.productImage?o.productImage:"/imgs/default.webp",V=m(0),g=m(0),_=()=>{let o=0,e=0,c=!0;n.value.forEach(d=>{d.selectedBoolean?(o+=d.price*d.cartQuantity,e+=d.cartQuantity):c=!1}),V.value=o,g.value=e,h.value=n.value.length>0&&c},B=async(o,e)=>{_();try{await b.post("/cart/update",{cartId:o.cartId,cartQuantity:e})}catch(c){console.error(c)}},$=o=>{n.value.forEach(e=>{e.selectedBoolean=o}),_()},x=o=>{z.confirm("确定要删除这个商品吗?","提示",{type:"warning",confirmButtonText:"确定",cancelButtonText:"取消"}).then(async()=>{try{await b.delete(`/cart/delete/${o}`),A.success("删除成功"),C()}catch(e){console.error(e)}}).catch(()=>{})};return E(()=>{C()}),(o,e)=>{const c=f("el-checkbox"),d=f("el-input-number"),U=f("el-icon"),y=f("el-button");return p(),u("div",L,[t("div",j,[t("div",q,[t("h2",{class:"logo",onClick:e[0]||(e[0]=s=>o.$router.push("/"))},"大米商城"),e[5]||(e[5]=t("div",{class:"header-title"},[t("h2",null,"我的购物车"),t("p",null,"温馨提示：产品是否购买成功，以最终下单为准哦，请尽快结算")],-1))])]),n.value.length>0?(p(),u("div",G,[t("div",J,[t("div",K,[a(c,{modelValue:h.value,"onUpdate:modelValue":e[1]||(e[1]=s=>h.value=s),onChange:$},{default:v(()=>[...e[6]||(e[6]=[l("全选",-1)])]),_:1},8,["modelValue"])]),e[7]||(e[7]=N('<div class="col col-img" data-v-30b71380> </div><div class="col col-name" data-v-30b71380>商品名称</div><div class="col col-price" data-v-30b71380>单价</div><div class="col col-num" data-v-30b71380>数量</div><div class="col col-total" data-v-30b71380>小计</div><div class="col col-action" data-v-30b71380>操作</div>',6))]),t("div",P,[(p(!0),u(S,null,T(n.value,(s,de)=>(p(),u("div",{class:"cart-item",key:s.cartId},[t("div",H,[a(c,{modelValue:s.selectedBoolean,"onUpdate:modelValue":r=>s.selectedBoolean=r,onChange:_},null,8,["modelValue","onUpdate:modelValue"])]),t("div",O,[t("img",{src:I(s),alt:""},null,8,R)]),t("div",W,i(s.productName),1),t("div",X,i(s.price)+"元",1),t("div",Y,[a(d,{modelValue:s.cartQuantity,"onUpdate:modelValue":r=>s.cartQuantity=r,min:1,size:"small",onChange:r=>B(s,r)},null,8,["modelValue","onUpdate:modelValue","onChange"])]),t("div",Z,i((s.price*s.cartQuantity).toFixed(2))+"元 ",1),t("div",ee,[a(U,{class:"del-icon",onClick:r=>x(s.cartId)},{default:v(()=>[a(F(M))]),_:1},8,["onClick"])])]))),128))]),t("div",te,[t("div",oe,[a(y,{type:"text",onClick:e[2]||(e[2]=s=>o.$router.push("/"))},{default:v(()=>[...e[8]||(e[8]=[l("继续购物",-1)])]),_:1}),t("span",se,[e[9]||(e[9]=l("共 ",-1)),t("i",null,i(n.value.length),1),e[10]||(e[10]=l(" 件商品，已选择 ",-1)),t("i",null,i(g.value),1),e[11]||(e[11]=l(" 件",-1))])]),t("span",le,[e[12]||(e[12]=l(" 合计：",-1)),t("em",null,i(V.value),1),e[13]||(e[13]=l("元 ",-1))]),a(y,{class:"btn-primary",size:"large",disabled:g.value===0,onClick:e[3]||(e[3]=s=>o.$router.push("/checkout"))},{default:v(()=>[...e[14]||(e[14]=[l(" 去结算 ",-1)])]),_:1},8,["disabled"])])])):(p(),u("div",ae,[e[16]||(e[16]=t("h2",null,"购物车还是空的",-1)),a(y,{type:"primary",onClick:e[4]||(e[4]=s=>o.$router.push("/"))},{default:v(()=>[...e[15]||(e[15]=[l("马上去购物",-1)])]),_:1})]))])}}}),ie=D(ne,[["__scopeId","data-v-30b71380"]]);export{ie as default};
