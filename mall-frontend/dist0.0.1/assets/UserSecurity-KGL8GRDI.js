import{d as P,u as g,r as h,B as b,a as y,b as e,i as w,t as V,f as a,g as n,h as i,j as k,E as c,p as $,I as C,q as I,s as U,_ as x}from"./index-DSi-hGWH.js";const B={class:"security-page"},S={class:"site-header"},E={class:"container header-content"},N={class:"user-area"},q={class:"container"},M={class:"profile-layout"},T={class:"side-menu"},j={class:"avatar-box"},A=["src"],D={class:"menu-list"},F={class:"main-content"},R={class:"form-box"},z="https://cube.elemecdn.com/3/7c/3ea6beec64369c2642b92c6726f1epng.png",G=P({__name:"UserSecurity",setup(H){const r=g(),m=I(),u=h(!1),o=b({oldPassword:"",newPassword:"",confirmPassword:""}),f=async()=>{if(!o.oldPassword||!o.newPassword)return c.warning("密码不能为空");if(o.newPassword!==o.confirmPassword)return c.warning("两次输入的新密码不一致");if(o.oldPassword===o.newPassword)return c.warning("新密码不能与旧密码相同");u.value=!0;try{await $.post("/user/updatePassword",{userId:r.userInfo.userId,oldPassword:o.oldPassword,newPassword:o.newPassword}),C.alert("密码修改成功，请重新登录","提示",{confirmButtonText:"去登录",callback:()=>{r.logout(),m.push("/login")}})}catch(l){console.error(l)}finally{u.value=!1}};return(l,s)=>{const p=i("el-input"),d=i("el-form-item"),v=i("el-button"),_=i("el-form");return U(),y("div",B,[e("div",S,[e("div",E,[e("h2",{class:"logo",onClick:s[0]||(s[0]=t=>l.$router.push("/"))},"大米商城"),s[8]||(s[8]=e("div",{class:"header-title"},"个人中心",-1)),e("div",N,[e("span",{class:"link",onClick:s[1]||(s[1]=t=>l.$router.push("/"))},"返回首页")])])]),e("div",q,[e("div",M,[e("div",T,[e("div",j,[e("img",{src:w(r).userInfo.avatar||z,alt:"avatar"},null,8,A),e("h3",null,V(w(r).userInfo.nickname||w(r).userInfo.username),1)]),e("ul",D,[e("li",{onClick:s[2]||(s[2]=t=>l.$router.push("/user"))},"我的个人中心"),e("li",{onClick:s[3]||(s[3]=t=>l.$router.push("/order/list"))},"我的订单"),e("li",{onClick:s[4]||(s[4]=t=>l.$router.push("/user/address"))},"收货地址"),s[9]||(s[9]=e("li",{class:"active"},"账户安全",-1))])]),e("div",F,[s[11]||(s[11]=e("div",{class:"content-header"},[e("h3",null,"修改密码")],-1)),e("div",R,[a(_,{model:o,"label-width":"100px",style:{width:"400px"}},{default:n(()=>[a(d,{label:"原密码"},{default:n(()=>[a(p,{modelValue:o.oldPassword,"onUpdate:modelValue":s[5]||(s[5]=t=>o.oldPassword=t),type:"password","show-password":"",placeholder:"请输入当前密码"},null,8,["modelValue"])]),_:1}),a(d,{label:"新密码"},{default:n(()=>[a(p,{modelValue:o.newPassword,"onUpdate:modelValue":s[6]||(s[6]=t=>o.newPassword=t),type:"password","show-password":"",placeholder:"请输入新密码"},null,8,["modelValue"])]),_:1}),a(d,{label:"确认密码"},{default:n(()=>[a(p,{modelValue:o.confirmPassword,"onUpdate:modelValue":s[7]||(s[7]=t=>o.confirmPassword=t),type:"password","show-password":"",placeholder:"请再次输入新密码"},null,8,["modelValue"])]),_:1}),a(d,null,{default:n(()=>[a(v,{type:"primary",onClick:f,loading:u.value,class:"btn-save"},{default:n(()=>[...s[10]||(s[10]=[k("提交修改",-1)])]),_:1},8,["loading"])]),_:1})]),_:1},8,["model"])])])])])])}}}),K=x(G,[["__scopeId","data-v-a688e269"]]);export{K as default};
