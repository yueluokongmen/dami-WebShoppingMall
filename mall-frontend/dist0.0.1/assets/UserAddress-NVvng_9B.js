import{d as E,u as P,r as b,B,o as j,a as p,b as s,f as o,t as n,i as F,F as L,l as M,g as a,h as v,p as m,j as f,m as C,E as _,I as S,s as V,_ as O}from"./index-DSi-hGWH.js";const q={class:"user-address-page"},T={class:"site-header"},z={class:"container header-content"},G={class:"user-area"},H={class:"container"},J={class:"profile-layout"},K={class:"side-menu"},Q={class:"avatar-box"},R={class:"menu-list"},W={class:"main-content"},X={class:"address-box"},Y={class:"address-list"},Z={class:"name"},ee={key:0,class:"tag"},se={class:"tel"},te={class:"addr"},le={class:"actions"},de=["onClick"],oe=["onClick"],ae=["onClick"],ne={class:"dialog-footer"},re=E({__name:"UserAddress",setup(ie){const c=P(),g=b([]),r=b(!1),y=b(!1),l=B({addressId:null,receiverName:"",receiverPhone:"",province:"",city:"",district:"",detailedAddress:"",isDefault:0}),I=async()=>{if(c.userInfo.userId)try{const d=await m.get(`/address/list?userId=${c.userInfo.userId}`);g.value=d}catch(d){console.error(d)}},$=()=>{y.value=!1,Object.assign(l,{addressId:null,receiverName:"",receiverPhone:"",province:"",city:"",district:"",detailedAddress:""}),r.value=!0},w=d=>{y.value=!0,Object.assign(l,d),r.value=!0},A=async()=>{if(!l.receiverName||!l.receiverPhone||!l.detailedAddress){_.warning("请填写完整信息");return}const d={userId:c.userInfo.userId,...l};try{y.value?(await m.post("/address/update",d),_.success("修改成功")):(await m.post("/address/add",d),_.success("添加成功")),r.value=!1,I()}catch(e){console.error(e)}},x=async d=>{try{await m.post("/address/update",{userId:c.userInfo.userId,addressId:d.addressId,isDefault:1}),_.success("设置成功"),I()}catch(e){console.error(e)}},N=d=>{S.confirm("确定要删除这个地址吗?","提示",{type:"warning"}).then(async()=>{try{await m.delete(`/address/delete/${d}`),_.success("删除成功"),I()}catch{}}).catch(()=>{})};return j(()=>{I()}),(d,e)=>{const i=v("el-input"),u=v("el-form-item"),U=v("el-form"),k=v("el-button"),D=v("el-dialog");return V(),p("div",q,[s("div",T,[s("div",z,[s("h2",{class:"logo",onClick:e[0]||(e[0]=t=>d.$router.push("/"))},"大米商城"),e[12]||(e[12]=s("div",{class:"header-title"},"个人中心",-1)),s("div",G,[s("span",{class:"link",onClick:e[1]||(e[1]=t=>d.$router.push("/"))},"返回首页")])])]),s("div",H,[s("div",J,[s("div",K,[s("div",Q,[e[13]||(e[13]=s("img",{src:"https://images.unsplash.com/photo-1535713875002-d1d0cf377fde?w=100&h=100&fit=crop",alt:"avatar"},null,-1)),s("h3",null,n(F(c).userInfo.username||"大米用户"),1)]),s("ul",R,[s("li",{onClick:e[2]||(e[2]=t=>d.$router.push("/user"))},"我的个人中心"),s("li",{onClick:e[3]||(e[3]=t=>d.$router.push("/order/list"))},"我的订单"),e[14]||(e[14]=s("li",{class:"active"},"收货地址",-1)),e[15]||(e[15]=s("li",null,"账户安全",-1))])]),s("div",W,[e[18]||(e[18]=s("div",{class:"content-header"},[s("h3",null,"收货地址")],-1)),s("div",X,[s("div",Y,[(V(!0),p(L,null,M(g.value,t=>(V(),p("div",{class:"address-item",key:t.addressId},[s("div",Z,[f(n(t.receiverName)+" ",1),t.isDefault===1?(V(),p("span",ee,"默认")):C("",!0)]),s("div",se,n(t.receiverPhone),1),s("div",te,[f(n(t.province)+" "+n(t.city)+" "+n(t.district),1),e[16]||(e[16]=s("br",null,null,-1)),f(" "+n(t.detailedAddress),1)]),s("div",le,[s("span",{class:"btn-text",onClick:h=>w(t)},"修改",8,de),s("span",{class:"btn-text",onClick:h=>N(t.addressId)},"删除",8,oe),t.isDefault===0?(V(),p("span",{key:0,class:"btn-text set-default",onClick:h=>x(t)},"设为默认",8,ae)):C("",!0)])]))),128)),s("div",{class:"address-item add-new",onClick:$},[...e[17]||(e[17]=[s("div",{class:"icon"},"+",-1),s("div",null,"添加新地址",-1)])])])])])])]),o(D,{modelValue:r.value,"onUpdate:modelValue":e[11]||(e[11]=t=>r.value=t),title:y.value?"修改收货地址":"添加收货地址",width:"500px"},{footer:a(()=>[s("span",ne,[o(k,{onClick:e[10]||(e[10]=t=>r.value=!1)},{default:a(()=>[...e[19]||(e[19]=[f("取消",-1)])]),_:1}),o(k,{type:"primary",onClick:A},{default:a(()=>[...e[20]||(e[20]=[f("保存",-1)])]),_:1})])]),default:a(()=>[o(U,{model:l,"label-width":"100px"},{default:a(()=>[o(u,{label:"姓名"},{default:a(()=>[o(i,{modelValue:l.receiverName,"onUpdate:modelValue":e[4]||(e[4]=t=>l.receiverName=t),placeholder:"收货人姓名"},null,8,["modelValue"])]),_:1}),o(u,{label:"电话"},{default:a(()=>[o(i,{modelValue:l.receiverPhone,"onUpdate:modelValue":e[5]||(e[5]=t=>l.receiverPhone=t),placeholder:"11位手机号"},null,8,["modelValue"])]),_:1}),o(u,{label:"省份"},{default:a(()=>[o(i,{modelValue:l.province,"onUpdate:modelValue":e[6]||(e[6]=t=>l.province=t),placeholder:"如：广东省"},null,8,["modelValue"])]),_:1}),o(u,{label:"城市"},{default:a(()=>[o(i,{modelValue:l.city,"onUpdate:modelValue":e[7]||(e[7]=t=>l.city=t),placeholder:"如：深圳市"},null,8,["modelValue"])]),_:1}),o(u,{label:"区/县"},{default:a(()=>[o(i,{modelValue:l.district,"onUpdate:modelValue":e[8]||(e[8]=t=>l.district=t),placeholder:"如：南山区"},null,8,["modelValue"])]),_:1}),o(u,{label:"详细地址"},{default:a(()=>[o(i,{type:"textarea",modelValue:l.detailedAddress,"onUpdate:modelValue":e[9]||(e[9]=t=>l.detailedAddress=t),placeholder:"街道、楼牌号等"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])])}}}),ce=O(re,[["__scopeId","data-v-ce97eec4"]]);export{ce as default};
