import{d as J,u as O,r as d,c as F,o as W,a,b as s,w as S,e as V,v as X,f as c,g as u,h as k,i as h,F as r,t as n,n as Y,j as w,k as Z,l as _,m as M,p as m,q as ss,s as l,x as ts,y as es,z as os,A as as,_ as ls}from"./index-DSi-hGWH.js";const ns={class:"home"},cs={class:"site-header"},is={class:"container header-content"},rs={class:"header-search"},ds={type:"submit",class:"search-btn"},us={class:"right-actions"},ps={class:"user-area"},hs={class:"welcome"},_s={class:"cart-num"},vs={class:"cart-menu"},ms={key:0,class:"loading"},gs={key:1,class:"msg-empty"},fs={key:2,class:"mini-list-wrapper"},ys={class:"cart-list"},ks={class:"thumb"},ws=["src"],Cs=["title"],bs={class:"price-box"},Is={class:"cart-total"},$s={class:"info"},xs={class:"count"},Ms={class:"price"},Ns={class:"home-hero-container container"},Ls={class:"site-category"},Ds={class:"category-list"},Fs={href:"javascript:;",class:"title"},Ss={key:0,class:"children-col"},Vs=["onClick"],qs=["src"],Bs={class:"site-swiper"},Hs=["src"],Ps={class:"page-main"},Qs={class:"container"},Rs={class:"goods-box"},js={class:"goods-list"},zs=["onClick"],Es={class:"img-wrap"},Ts=["src"],Us={class:"name"},As={class:"desc"},Ks={class:"price"},Gs={key:0,class:"empty-floor"},Js={class:"goods-box"},Os={class:"goods-list"},Ws=["onClick"],Xs={class:"img-wrap"},Ys=["src"],Zs={class:"name"},st={class:"desc"},tt={class:"price"},et={key:0,class:"empty-floor"},q="https://images.unsplash.com/photo-1598327105666-5b89351aff23?w=100&h=100&fit=crop",ot=J({__name:"Home",setup(at){const v=O(),C=ss(),b=d([]),I=d([]),g=d(!1),$=d(!1),p=d([]),B=["https://images.unsplash.com/photo-1556656793-02774a8316ea?w=1226&h=460&fit=crop","https://images.unsplash.com/photo-1519389950473-47ba0277781c?w=1226&h=460&fit=crop","https://images.unsplash.com/photo-1598327105666-5b89351aff23?w=1226&h=460&fit=crop"],N=d([]),f=d(""),L=F(()=>p.value.reduce((o,t)=>o+t.cartQuantity,0)),H=F(()=>p.value.reduce((o,t)=>o+t.price*t.cartQuantity,0).toFixed(2)),P=()=>{f.value.trim()&&C.push({path:"/search",query:{keyword:f.value}})},Q=o=>{C.push({path:"/search",query:{familyId:o}})},R=async()=>{try{const o=await m.get("/home/nav");N.value=o}catch(o){console.error(o)}},j=async()=>{try{const o=await m.get("/spu/search",{params:{categoryId:1}});b.value=o;const t=await m.get("/spu/search",{params:{categoryId:2}});I.value=t}catch(o){console.error(o)}},x=async()=>{if(v.userInfo.userId){$.value=!0;try{const o=await m.get(`/cart/list?userId=${v.userInfo.userId}`);p.value=o}catch{}finally{$.value=!1}}},z=()=>{g.value=!0,x()},E=async o=>{try{await m.delete(`/cart/delete/${o}`),x()}catch{}},T=()=>{v.logout(),p.value=[]},D=o=>{C.push(`/detail/${o.productId}`)},U=o=>{o.target.src=q};return W(()=>{R(),j(),x()}),(o,t)=>{const y=k("el-icon"),A=k("el-button"),K=k("el-carousel-item"),G=k("el-carousel");return l(),a("div",ns,[s("div",cs,[s("div",is,[t[13]||(t[13]=s("h2",{class:"logo"},"大米商城",-1)),s("div",rs,[s("form",{class:"search-form",onSubmit:S(P,["prevent"])},[V(s("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=e=>f.value=e),class:"search-text",placeholder:"搜索商品名称"},null,512),[[X,f.value]]),s("button",ds,[c(y,null,{default:u(()=>[c(h(ts))]),_:1})])],32)]),s("div",us,[s("div",ps,[h(v).userInfo.username?(l(),a(r,{key:0},[s("span",hs,"欢迎，"+n(h(v).userInfo.username),1),t[7]||(t[7]=s("span",{class:"sep"},"|",-1)),s("span",{class:"link",onClick:t[1]||(t[1]=e=>o.$router.push("/user"))},"个人中心"),t[8]||(t[8]=s("span",{class:"sep"},"|",-1)),s("span",{class:"link",onClick:T},"退出")],64)):(l(),a(r,{key:1},[s("span",{class:"link",onClick:t[2]||(t[2]=e=>o.$router.push("/login"))},"登录"),t[9]||(t[9]=s("span",{class:"sep"},"|",-1)),s("span",{class:"link",onClick:t[3]||(t[3]=e=>o.$router.push("/register"))},"注册")],64))]),s("div",{class:"topbar-cart",onMouseenter:z,onMouseleave:t[6]||(t[6]=e=>g.value=!1)},[s("div",{class:Y(["cart-mini",{active:g.value}]),onClick:t[4]||(t[4]=e=>o.$router.push("/cart"))},[c(y,{class:"icon"},{default:u(()=>[c(h(es))]),_:1}),t[10]||(t[10]=w(" 购物车 ",-1)),s("span",_s,"("+n(L.value)+")",1)],2),V(s("div",vs,[$.value?(l(),a("div",ms,"加载中...")):p.value.length===0?(l(),a("div",gs,"购物车中还没有商品，赶紧选购吧！")):(l(),a("div",fs,[s("ul",ys,[(l(!0),a(r,null,_(p.value.slice(0,5),e=>(l(),a("li",{key:e.cartId,class:"cart-item"},[s("div",ks,[s("img",{src:e.productImage||q,onError:U},null,40,ws)]),s("div",{class:"name",title:e.productName},n(e.productName),9,Cs),s("div",bs,n(e.price)+"元 × "+n(e.cartQuantity),1),c(y,{class:"del-btn",onClick:S(i=>E(e.cartId),["stop"])},{default:u(()=>[c(h(os))]),_:1},8,["onClick"])]))),128))]),s("div",Is,[s("div",$s,[s("div",xs,"共 "+n(L.value)+" 件商品",1),s("div",Ms,[s("span",null,n(H.value),1),t[11]||(t[11]=w("元",-1))])]),c(A,{color:"#ff6700",class:"btn-go",onClick:t[5]||(t[5]=e=>o.$router.push("/cart"))},{default:u(()=>[...t[12]||(t[12]=[w("去购物车结算",-1)])]),_:1})])]))],512),[[Z,g.value]])],32)])])]),s("div",Ns,[s("div",Ls,[s("ul",Ds,[(l(!0),a(r,null,_(N.value,e=>(l(),a("li",{key:e.id,class:"category-item"},[s("a",Fs,[w(n(e.name)+" ",1),c(y,null,{default:u(()=>[c(h(as))]),_:1})]),e.children&&e.children.length>0?(l(),a("div",Ss,[(l(!0),a(r,null,_(e.children,i=>(l(),a("div",{key:i.id,class:"sub-item",onClick:lt=>Q(i.id)},[s("img",{src:i.img,alt:""},null,8,qs),s("span",null,n(i.name),1)],8,Vs))),128))])):M("",!0)]))),128))])]),s("div",Bs,[c(G,{height:"460px",trigger:"click",interval:4e3},{default:u(()=>[(l(),a(r,null,_(B,(e,i)=>c(K,{key:i},{default:u(()=>[s("img",{src:e,class:"swiper-img"},null,8,Hs)]),_:2},1024)),64))]),_:1})])]),s("div",Ps,[s("div",Qs,[t[16]||(t[16]=s("h2",{class:"section-title"},"手机",-1)),s("div",Rs,[t[14]||(t[14]=s("div",{class:"promo-card"},[s("img",{src:"https://images.unsplash.com/photo-1550029402-2261131787cd?w=234&h=614&fit=crop",alt:""})],-1)),s("div",js,[(l(!0),a(r,null,_(b.value.slice(0,8),e=>(l(),a("div",{key:e.productId,class:"goods-card",onClick:i=>D(e)},[s("div",Es,[s("img",{src:e.images&&e.images[0]?e.images[0]:"",alt:""},null,8,Ts)]),s("h3",Us,n(e.productName),1),s("p",As,n(e.subtitle||"旗舰性能，超清影像"),1),s("p",Ks,"¥ "+n(e.spuPrice),1)],8,zs))),128)),b.value.length===0?(l(),a("div",Gs,"暂无手机商品")):M("",!0)])]),t[17]||(t[17]=s("h2",{class:"section-title"},"笔记本 平板",-1)),s("div",Js,[t[15]||(t[15]=s("div",{class:"promo-card"},[s("img",{src:"https://images.unsplash.com/photo-1556911220-e15b29be8c8f?w=234&h=614&fit=crop",alt:""})],-1)),s("div",Os,[(l(!0),a(r,null,_(I.value.slice(0,8),e=>(l(),a("div",{key:e.productId,class:"goods-card",onClick:i=>D(e)},[s("div",Xs,[s("img",{src:e.images&&e.images[0]?e.images[0]:"",alt:""},null,8,Ys)]),s("h3",Zs,n(e.productName),1),s("p",st,n(e.subtitle||"生产力工具，轻薄便携"),1),s("p",tt,"¥ "+n(e.spuPrice),1)],8,Ws))),128)),I.value.length===0?(l(),a("div",et,"暂无笔记本商品")):M("",!0)])])])]),t[18]||(t[18]=s("div",{class:"site-footer"},[s("div",{class:"container"},"大米商城 © 2025 Mi Mall Demo")],-1))])}}}),ct=ls(ot,[["__scopeId","data-v-8261cd55"]]);export{ct as default};
