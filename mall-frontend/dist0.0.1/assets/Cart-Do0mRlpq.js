import{d as w,u as E,r as _,o as Q,a as u,b as t,G as N,f as a,g as v,h as f,F as S,l as T,j as l,t as i,p as k,i as F,H as M,s as p,I as z,E as A,_ as D}from"./index-DSi-hGWH.js";const L={class:"cart-page"},j={class:"site-header"},q={class:"container header-content"},G={key:0,class:"container cart-container"},H={class:"cart-header"},P={class:"col col-check"},J={class:"cart-item-list"},K={class:"col col-check"},O={class:"col col-img"},R=["src"],W={class:"col col-name"},X={class:"col col-price"},Y={class:"col col-num"},Z={class:"col col-total",style:{color:"#ff6700"}},ee={class:"col col-action"},te={class:"cart-bar"},oe={class:"section-left"},se={class:"total-count"},le={class:"total-price"},ae={key:1,class:"container empty-cart"},ne=w({__name:"Cart",setup(ce){const C=E(),n=_([]),h=_(!0),V=async()=>{if(!C.userInfo.userId)return;const s=await k.get(`/cart/list?userId=${C.userInfo.userId}`);n.value=s.map(e=>({...e,selectedBoolean:e.selected===1})),m()},I=s=>"https://images.unsplash.com/photo-1598327105666-5b89351aff23?w=100&h=100&fit=crop",b=_(0),g=_(0),m=()=>{let s=0,e=0,c=!0;n.value.forEach(d=>{d.selectedBoolean?(s+=d.price*d.cartQuantity,e+=d.cartQuantity):c=!1}),b.value=s,g.value=e,h.value=n.value.length>0&&c},B=async(s,e)=>{m();try{await k.post("/cart/update",{cartId:s.cartId,cartQuantity:e})}catch(c){console.error(c)}},$=s=>{n.value.forEach(e=>{e.selectedBoolean=s}),m()},x=s=>{z.confirm("确定要删除这个商品吗?","提示",{type:"warning",confirmButtonText:"确定",cancelButtonText:"取消"}).then(async()=>{try{await k.delete(`/cart/delete/${s}`),A.success("删除成功"),V()}catch(e){console.error(e)}}).catch(()=>{})};return Q(()=>{V()}),(s,e)=>{const c=f("el-checkbox"),d=f("el-input-number"),U=f("el-icon"),y=f("el-button");return p(),u("div",L,[t("div",j,[t("div",q,[t("h2",{class:"logo",onClick:e[0]||(e[0]=o=>s.$router.push("/"))},"大米商城"),e[5]||(e[5]=t("div",{class:"header-title"},[t("h2",null,"我的购物车"),t("p",null,"温馨提示：产品是否购买成功，以最终下单为准哦，请尽快结算")],-1))])]),n.value.length>0?(p(),u("div",G,[t("div",H,[t("div",P,[a(c,{modelValue:h.value,"onUpdate:modelValue":e[1]||(e[1]=o=>h.value=o),onChange:$},{default:v(()=>[...e[6]||(e[6]=[l("全选",-1)])]),_:1},8,["modelValue"])]),e[7]||(e[7]=N('<div class="col col-img" data-v-09cec7d5> </div><div class="col col-name" data-v-09cec7d5>商品名称</div><div class="col col-price" data-v-09cec7d5>单价</div><div class="col col-num" data-v-09cec7d5>数量</div><div class="col col-total" data-v-09cec7d5>小计</div><div class="col col-action" data-v-09cec7d5>操作</div>',6))]),t("div",J,[(p(!0),u(S,null,T(n.value,(o,de)=>(p(),u("div",{class:"cart-item",key:o.cartId},[t("div",K,[a(c,{modelValue:o.selectedBoolean,"onUpdate:modelValue":r=>o.selectedBoolean=r,onChange:m},null,8,["modelValue","onUpdate:modelValue"])]),t("div",O,[t("img",{src:I(),alt:""},null,8,R)]),t("div",W,i(o.productName),1),t("div",X,i(o.price)+"元",1),t("div",Y,[a(d,{modelValue:o.cartQuantity,"onUpdate:modelValue":r=>o.cartQuantity=r,min:1,size:"small",onChange:r=>B(o,r)},null,8,["modelValue","onUpdate:modelValue","onChange"])]),t("div",Z,i((o.price*o.cartQuantity).toFixed(2))+"元 ",1),t("div",ee,[a(U,{class:"del-icon",onClick:r=>x(o.cartId)},{default:v(()=>[a(F(M))]),_:1},8,["onClick"])])]))),128))]),t("div",te,[t("div",oe,[a(y,{type:"text",onClick:e[2]||(e[2]=o=>s.$router.push("/"))},{default:v(()=>[...e[8]||(e[8]=[l("继续购物",-1)])]),_:1}),t("span",se,[e[9]||(e[9]=l("共 ",-1)),t("i",null,i(n.value.length),1),e[10]||(e[10]=l(" 件商品，已选择 ",-1)),t("i",null,i(g.value),1),e[11]||(e[11]=l(" 件",-1))])]),t("span",le,[e[12]||(e[12]=l(" 合计：",-1)),t("em",null,i(b.value),1),e[13]||(e[13]=l("元 ",-1))]),a(y,{class:"btn-primary",size:"large",disabled:g.value===0,onClick:e[3]||(e[3]=o=>s.$router.push("/checkout"))},{default:v(()=>[...e[14]||(e[14]=[l(" 去结算 ",-1)])]),_:1},8,["disabled"])])])):(p(),u("div",ae,[e[16]||(e[16]=t("h2",null,"购物车还是空的",-1)),a(y,{type:"primary",onClick:e[4]||(e[4]=o=>s.$router.push("/"))},{default:v(()=>[...e[15]||(e[15]=[l("马上去购物",-1)])]),_:1})]))])}}}),ie=D(ne,[["__scopeId","data-v-09cec7d5"]]);export{ie as default};
