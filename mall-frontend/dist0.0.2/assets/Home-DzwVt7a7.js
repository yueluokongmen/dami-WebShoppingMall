import{d as J,u as O,r as d,c as B,o as W,a as n,b as s,w as F,e as S,v as X,f as i,g as u,h as k,i as _,F as c,t as l,n as Y,j as w,k as Z,l as v,m as C,p as m,q as ss,s as a,x as ts,y as es,z as os,A as as,B as ns,C as ls,_ as is}from"./index-Cvb7EvRk.js";const rs="/imgs/sidebar1.webp",cs="/imgs/sidebar2.webp",ds={class:"home"},us={class:"site-header"},ps={class:"container header-content"},_s={class:"header-search"},vs={type:"submit",class:"search-btn"},hs={class:"right-actions"},ms={class:"user-area"},gs={class:"welcome"},fs={class:"cart-num"},ys={class:"cart-menu"},ks={key:0,class:"loading"},ws={key:1,class:"msg-empty"},Cs={key:2,class:"mini-list-wrapper"},bs={class:"cart-list"},Is={class:"thumb"},$s=["src"],xs=["title"],Ms={class:"price-box"},Ns={class:"cart-total"},Ds={class:"info"},Ls={class:"count"},Bs={class:"price"},Fs={class:"home-hero-container container"},Ss={class:"site-category"},Vs={class:"category-list"},qs={href:"javascript:;",class:"title"},Hs={class:"category-icon"},js={key:0,class:"children-col"},Ps=["onClick"],Qs=["src"],Rs={class:"site-swiper"},zs=["src"],Es={class:"page-main"},Ts={class:"container"},Us={class:"goods-box"},As={class:"goods-list"},Ks=["onClick"],Gs={class:"img-wrap"},Js=["src"],Os={class:"name"},Ws={class:"desc"},Xs={class:"price"},Ys={key:0,class:"empty-floor"},Zs={class:"goods-box"},st={class:"goods-list"},tt=["onClick"],et={class:"img-wrap"},ot=["src"],at={class:"name"},nt={class:"desc"},lt={class:"price"},it={key:0,class:"empty-floor"},V="/imgs/default.webp",rt=J({__name:"Home",setup(ct){const h=O(),b=ss(),I=d([]),$=d([]),g=d(!1),x=d(!1),p=d([]),q=["/imgs/lunbotu1.jpg","/imgs/lunbotu2.webp","/imgs/lunbotu3.webp"],N=d([]),f=d(""),D=B(()=>p.value.reduce((o,t)=>o+t.cartQuantity,0)),H=B(()=>p.value.reduce((o,t)=>o+t.price*t.cartQuantity,0).toFixed(2)),j=()=>{f.value.trim()&&b.push({path:"/search",query:{keyword:f.value}})},P=o=>{b.push({path:"/search",query:{familyId:o}})},Q=async()=>{try{const o=await m.get("/home/nav");N.value=o}catch(o){console.error(o)}},R=async()=>{try{const o=await m.get("/spu/search",{params:{categoryId:1}});I.value=o;const t=await m.get("/spu/search",{params:{categoryId:2}});$.value=t}catch(o){console.error(o)}},M=async()=>{if(h.userInfo.userId){x.value=!0;try{const o=await m.get(`/cart/list?userId=${h.userInfo.userId}`);p.value=o}catch{}finally{x.value=!1}}},z=()=>{g.value=!0,M()},E=async o=>{try{await m.delete(`/cart/delete/${o}`),M()}catch{}},T=()=>{h.logout(),p.value=[]},L=o=>{b.push(`/detail/${o.productId}`)},U=o=>{o.target.src=V};return W(()=>{Q(),R(),M()}),(o,t)=>{const y=k("el-icon"),A=k("el-button"),K=k("el-carousel-item"),G=k("el-carousel");return a(),n("div",ds,[s("div",us,[s("div",ps,[t[13]||(t[13]=s("h2",{class:"logo"},"大米商城",-1)),s("div",_s,[s("form",{class:"search-form",onSubmit:F(j,["prevent"])},[S(s("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=e=>f.value=e),class:"search-text",placeholder:"搜索商品名称"},null,512),[[X,f.value]]),s("button",vs,[i(y,null,{default:u(()=>[i(_(ts))]),_:1})])],32)]),s("div",hs,[s("div",ms,[_(h).userInfo.username?(a(),n(c,{key:0},[s("span",gs,"欢迎，"+l(_(h).userInfo.username),1),t[7]||(t[7]=s("span",{class:"sep"},"|",-1)),s("span",{class:"link",onClick:t[1]||(t[1]=e=>o.$router.push("/user"))},"个人中心"),t[8]||(t[8]=s("span",{class:"sep"},"|",-1)),s("span",{class:"link",onClick:T},"退出")],64)):(a(),n(c,{key:1},[s("span",{class:"link",onClick:t[2]||(t[2]=e=>o.$router.push("/login"))},"登录"),t[9]||(t[9]=s("span",{class:"sep"},"|",-1)),s("span",{class:"link",onClick:t[3]||(t[3]=e=>o.$router.push("/register"))},"注册")],64))]),s("div",{class:"topbar-cart",onMouseenter:z,onMouseleave:t[6]||(t[6]=e=>g.value=!1)},[s("div",{class:Y(["cart-mini",{active:g.value}]),onClick:t[4]||(t[4]=e=>o.$router.push("/cart"))},[i(y,{class:"icon"},{default:u(()=>[i(_(es))]),_:1}),t[10]||(t[10]=w(" 购物车 ",-1)),s("span",fs,"("+l(D.value)+")",1)],2),S(s("div",ys,[x.value?(a(),n("div",ks,"加载中...")):p.value.length===0?(a(),n("div",ws,"购物车中还没有商品，赶紧选购吧！")):(a(),n("div",Cs,[s("ul",bs,[(a(!0),n(c,null,v(p.value.slice(0,5),e=>(a(),n("li",{key:e.cartId,class:"cart-item"},[s("div",Is,[s("img",{src:e.productImage||V,onError:U},null,40,$s)]),s("div",{class:"name",title:e.productName},l(e.productName),9,xs),s("div",Ms,l(e.price)+"元 × "+l(e.cartQuantity),1),i(y,{class:"del-btn",onClick:F(r=>E(e.cartId),["stop"])},{default:u(()=>[i(_(os))]),_:1},8,["onClick"])]))),128))]),s("div",Ns,[s("div",Ds,[s("div",Ls,"共 "+l(D.value)+" 件商品",1),s("div",Bs,[s("span",null,l(H.value),1),t[11]||(t[11]=w("元",-1))])]),i(A,{color:"#ff6700",class:"btn-go",onClick:t[5]||(t[5]=e=>o.$router.push("/cart"))},{default:u(()=>[...t[12]||(t[12]=[w("去购物车结算",-1)])]),_:1})])]))],512),[[Z,g.value]])],32)])])]),s("div",Fs,[s("div",Ss,[s("ul",Vs,[(a(!0),n(c,null,v(N.value,e=>(a(),n("li",{key:e.id,class:"category-item"},[s("a",qs,[s("span",Hs,[e.icon?(a(),as(ns(e.icon),{key:0,style:{width:"18px",height:"18px","margin-right":"8px","vertical-align":"middle"}})):C("",!0)]),w(" "+l(e.name)+" ",1),i(y,{class:"arrow-right"},{default:u(()=>[i(_(ls))]),_:1})]),e.children&&e.children.length>0?(a(),n("div",js,[(a(!0),n(c,null,v(e.children,r=>(a(),n("div",{key:r.id,class:"sub-item",onClick:dt=>P(r.id)},[s("img",{src:r.img,alt:""},null,8,Qs),s("span",null,l(r.name),1)],8,Ps))),128))])):C("",!0)]))),128))])]),s("div",Rs,[i(G,{height:"460px",trigger:"click",interval:4e3},{default:u(()=>[(a(),n(c,null,v(q,(e,r)=>i(K,{key:r},{default:u(()=>[s("img",{src:e,class:"swiper-img"},null,8,zs)]),_:2},1024)),64))]),_:1})])]),s("div",Es,[s("div",Ts,[t[16]||(t[16]=s("h2",{class:"section-title"},"手机",-1)),s("div",Us,[t[14]||(t[14]=s("div",{class:"promo-card"},[s("img",{src:rs,alt:""})],-1)),s("div",As,[(a(!0),n(c,null,v(I.value.slice(0,8),e=>(a(),n("div",{key:e.productId,class:"goods-card",onClick:r=>L(e)},[s("div",Gs,[s("img",{src:e.images&&e.images[0]?e.images[0]:"",alt:""},null,8,Js)]),s("h3",Os,l(e.productName),1),s("p",Ws,l(e.subtitle||"旗舰性能，超清影像"),1),s("p",Xs,"¥ "+l(e.spuPrice),1)],8,Ks))),128)),I.value.length===0?(a(),n("div",Ys,"暂无手机商品")):C("",!0)])]),t[17]||(t[17]=s("h2",{class:"section-title"},"笔记本 平板",-1)),s("div",Zs,[t[15]||(t[15]=s("div",{class:"promo-card"},[s("img",{src:cs,alt:""})],-1)),s("div",st,[(a(!0),n(c,null,v($.value.slice(0,8),e=>(a(),n("div",{key:e.productId,class:"goods-card",onClick:r=>L(e)},[s("div",et,[s("img",{src:e.images&&e.images[0]?e.images[0]:"",alt:""},null,8,ot)]),s("h3",at,l(e.productName),1),s("p",nt,l(e.subtitle||"生产力工具，轻薄便携"),1),s("p",lt,"¥ "+l(e.spuPrice),1)],8,tt))),128)),$.value.length===0?(a(),n("div",it,"暂无笔记本商品")):C("",!0)])])])]),t[18]||(t[18]=s("div",{class:"site-footer"},[s("div",{class:"container"},"大米商城 © 2025 Mi Mall Demo")],-1))])}}}),pt=is(rt,[["__scopeId","data-v-47894034"]]);export{pt as default};
